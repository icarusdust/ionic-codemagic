 workflows:
    ionic-capacitor-android-workflow:
          name: Ionic Capacitor Android Workflow
          max_build_duration: 120
          instance_type: linux_x2
          environment:
              vars:
                # Android Keystore environment variables
                CM_KEYSTORE: Encrypted(Z0FBQUFBQmcwNzd3Y1FLZnlNTWN6SEU5b1htTjJRQ2xsck9oc2NGNUhvUVFRVzdZOFd1YnlCZHAxYVkxSGRHdTNtQkYxSUxpd1k2ZW5HeHBFWGRMTzAwRWZwaFU1eS1EeXE2VEIxbHJVbzBSUzQ2cWxFVU5nWC02XzNhUkdRXzhmcjhIS19rLVBRU3NTSjRpT2pDcEVJeEYwTXdNOTFfM0hHRGZyTzNSTFAwdUtZcHhqUFBoSmRtd2tBUkUyMEE0d1ZERFhUNTIteEpVQTNYRzJ2ZzlMbkx4WUtscDc4VkQ3cFVmdXFNa0xkN0kzWjBGaEJjY3N6cWU3Z2tWTGgya1NaSTdoVU5lWTFtODBfc1lZUU9TOXl1MG9vU3ZoWHNsRUxmUmFGQ0JJby03bW1qTHdQb2xQWTVYLVQ2TUVlRHhqRjl3QVNnUnIzbU8xZnI0c1F6RlNVTzBTM0RkbWNFZ2hORHZQYjdWTDJtZGtiWml5b3RBU1pGREhMYXoyOXp3OWhLai0ycGduc3N4VEdzekhpdnA0QkUyb1pDSGNEaTUtX3VETERvekNqRld1cVY0VV8zSmhZdEh6ZzRyNHhxTktiZERGRUNGb1lSWFV5YVdqSGhVLWpBLXpPMHFBaktGZk1pam54YjdSN043MWdla2tPU05VT25xc292dXQ4c0FoVWZPOXN5X1c5eGlhUFZRVlctTEhNNE45Y0RyTTA2MmZ0S3R1Vnh2NXp6MGg1ZFJHYjNnc3NoZjRDOEp1c2tkN3MzVEpTd2M1aHJkM1duWk5QSXNyaHRkdjZFZTI5cjdObnA1VmNkZThGUVpuaUtHMkVseDdHTzVRMElrZWRWQXVua25JZ01pU1ZhMW51YVpLQ0Q2d3pST2JqX3dCQ3kzM0RTdFh2aHN5LTdLdzRxR25ULUZCNmg4cVh4WmU4R0hDa1FScWNnNlFRazVKQldPT19HWFdSeDVoSGo1S0QwRnhvWU4xbEtpT0w3ajVjTkNndU1SdlRFbkU0UURYdkZWYnUxYkM5bDlyY3FkbU1DaWVKTnVlQUZ5SWJlWEQtaWlZdW43ZjFKTnE0Z2JRczNZSktWUmhaZ0tRZFNiVGEtQmx4emRDbjJTVm5pM09OcWV3TDBGRG5tcnR2clNGcDJ3TUdlcmgyOUFOOVNGNklSbkRjNkwxMlZwb2JHZ2pKSmpYTEtfNFZMU1hhdExZX0VIMGlqN1NsSHBFVzRWM2ZaLXd6ODVDMTA5QkVXa1g4UmN1REozT2V6OGhvbDNvU0thU0VEc0FWTDdPTHpyRUk1aUdoVTQ2UUZOLW5pcmtGSm9rY19wdWt4YlBjUkZla2pjemszdVM0eDZOa0s2MnhPY2FCaFhmcExmSllnTElaYXV4ejlkWTZQcDVkYjl5cm5fbks5LVpGZ2c5cmhPY0Nyd1h5UTJYUUU1YkkxbFQ2MHNSME9YOVd2amt0bFlnVk5lalpBUjhCOUxxVEhLMEhhMndMZkg4cEFjVUdiNDdIVzB2QWVXdHVkLXdhLVRZV3VFTzVqM05DY0NHa0d5UTE5MHZNZ09QUFU3MmdudUE1WXdqX3NpTHh2NHlhd3NZNTBYWTZFV0x6SEp6QXg3NVhnYlpuWWpYYmJILTRjY0xQT2syUXRGLTAyTVdaMGJfOEdWS0ZEY1ZHVTZjQjBCdXd6XzJtSGgzWTdwcWFsTjFuWENKaUJQbDc0VElYaGZXWmkwZVJjMy16ZG96Z2JCS3h5T2c1YzlsWWJOV2VwMmVvM1piYndZQnlMMlE5RFNITV9YRjAwNV82X3Y3NWt3cjhqRTBxUlhSX0llTTZpNklSazhvWGpGUThka29KVThfX09qTEkwUW9SWjRqQWl1djgzNU9ZX2Z2cmI2X0lKWVBrT2kyczRNQlA1WkVWcXZoWUhDck5ONXdlZFhKaWJIZF9lS0dtOEdQZXcxVXpOQ25kQ1p2UjNjcVhpcWQ0X2hiX3RxTGxhZkcxRDd3UUk5MHFkeENKSlBPdW1nbzV5N0xfbE9hTml4bGdDbU9pV0wwMzh4cVVUdU9JN0tQY0pZcFBZLVFQc3dXeUt5enNNZFVDRTV4Mlh2T0VhU2trNXhZYzh5M2ZXbklvdGxYdU1ZT2I5M0VVUTh5eGtqd3ZpTXU1WDBTeTRqNEt2YVJCNEsydUJ0U09jMW5JMURWYUJVNWdDU25keXpFNDBDZko5WXZmNTJzVnlQVkZqd2ZBWVNwbHlJalJWUFQyZW00SU5FUUJJdUdiLVFwVjBhdGhldUMzNUdXTGc1eTdjOTFtSlJYUHd4c0p3M21DYmdfS1I2ZTE3eEExOWVkT0ZMWlVBY0pRNDlIZTZuVEh4SERFcEFZVGF2cWR5dzA3aEZwdTcybXpnb01tek5yeUV5SG1nVG5VR2xFZjd3UnBTbE9uY0E5TjdKaFFhRW5VN25FeFY0SXFoQ09xeVlCc0dsSTBTUTVnMXFoU2Nqa3BBV21GbzR0U1JXZlc3b3g2OWhsR1l2MHdkOTZKS1N2Wkd4RGxJOGhyOUhRdlA4NUZvYlRyNHVnVGpfOFM4RkItX0xpV3hPVGwydmlTUzZnT0dFUTRiMG1KYVY3YXVkWm9kYk9CbUtBbFFGeGFZSjhIamhBRjB6c0ZIY21qWU1hUUZReGdBbm92WURvTmVmV21Bbm5Cc3daUVJNY2o4NlVjdGhtbV80bFp1akFHZUgzcExONVlFa0lYVzZxc3R5ZGE5Z3dINWVBSDBFV09XaUd2bGZVaVl6SVp1a0pJZzE1M0drRmxrSEVud253QjhPTGhQbEg2OHBzbVNTTi1GRHhBcFdHR3g4cG1tN3hhTVNzYmVXeHZIS3g2N2JhMVRGZkJDdmFMN2t4aWZpTlcwZzV3VDRvZ3d1MG42MzRCSVFIUE1nVVFCaDBpVVpMY2FUcVNBV25YLWU3Q1pWSVBXeDMtb2IzcEJkVkZIdDNOMHBoRVNGMGJaZ3NFeXFWeGppNVIzWUViclNHOTVkbVo4WG9jc01FeC10RkRXS0ljVXVFNlRjZEZ1VC1kM01xWWlHVUwzUVFvYnc5ZVJnVXBZU0ZsYzFzcVNtRlN3Y2tQb1BGRXYyUmp0OVFPMDFBNXFGVzM1eXpqRFc3TjJySzAzZ0hKd1R2UjlIbW00UEpBTUpxRWlWaXY4VEVsZHBhWEV1cUJMRDRHY0lkb2hyU0w3V2lwZy1sY1c0NUdIN0tlRFhPUGdJbXRhTzd2Ul82QVRya0NtUXVMOWVDNERlenEyb2M1VVhXZ2hfVmFYSC1HSDdLS09jZFhJSTg2X0lsVGhxU19ManNON3M1YVN4TkJKSXRjTHlpcVB2TkVTclg4Y0phLTdXLUtkRmdHRl9mLWNXdG43N09laEhQM1BNUGNZUDdRWE9CM2tZemVET3d0S09FUm8zY1pIUkhFV0VfUU8ta3ZsdGFocE41cDRjb1VPY2swMGN0d2VsbWJFY2hmYVJpdHl2QjVkQ0NsbzRpNE5sejdaNU5rSzlJZjhFMG5VcDIwclBkcXY3dkVKa29odWhCNDVBbzlHenpUREJBdW94TnRzNTF3UnIxS0Y2X3N5eml4aHhRNG5EMGdEeU93dTBFQlp3WmI3SEowV2NPcWZ0VXZwQnU4Tkh6dm1zWVpBX0E3bVZRUmN2WGtKSjFEUW5NbzdBSUVsZXI0bUFmUlpRT1RCYWFIM2xMZGE1aUFRRkpHX0YtQ1pKSDhQVEw4cHp4WlhZdlFpR19iUFRBaEpIQlhtOW9UcmdaVS1jcjh2bi1waGJWTGdURml6RnZseGdHNl9EZHhDMFJRRTdlUWxLZ1JjNWYyNWN6RXE2RTBiQUdqQm5OSUJfcHgxU0pTTDFPMmd6NUxBUEdrN0FaNjR1RjExN0JyTUh2c2lldVdOTGRrMnc4bU5JR2MwMTdjZEJTX1ZiQ1NwQ0dESkdQck1sZmk5TDJ4N0lJb056QjhFRllLUWpvalhTM3pmOUVLOFZCX191czg0X3RYOGpWdW1GNzFIYzVOd3g0QUZYRzlfaFYzbzlFa3p4a2xObHJqd0Z4UWE2V3htRzhIMk5TaWZ1YkhzY3prenNRVXhIUDcwXzN6T1FGbGYya0h2V1hGejRzX2JqSFF1QU83WTV6Y1QzeWtIWUtnOTZRZUFOSVZzWENsZXpGdnZmcFBZVTh0REtlUWxlWlpWMDJBbzdEbVFZY2owM1ZQaFctR191WVdlMTJXUjhCSlg4bGNiRUN3aFp3QkVTanlzMzdnOElZLUFSTlNSRlgzOWUyZUpNTGVnRVdoVlVTTHZELUhYci0xbnROVVMtZVFKRGxtLUlEY2V4UUNsZWFHSjVxdk9JM0tERS1tS3ZILUg3aENqaTkwdGxuaXRCUUNOTnpyd1plSmdTLTBlSDlMa1pVWXJVZWhkV05iLW9yVmhIXzlMWVRJeWFUcDdDdkRmWFZoUm9ISHNyU1pzM2RCNmdad1p2Y2Y2OVdINEV6STZsTUMyOGk3bGoyUVNzbFNwMDhNWWd0Ni1ZWTdWcF9UTnJwR3BKUDJBVldVdERuaVhmLTVJYWxuZmtBWXVpdXZiWVRXcTU2X2pDUEpxMHRpNnVKNTh6eUpZaVRScDdjWDdhRG5kTzFZd1g2VU8zZndUX3owU2ZjVTllcmpQbnMwZkFLa2JlLUlac3dTYmVPVHZRdlhTb1FJRGlaWVUwaTJIb2s5UnhJWTBaUTlRUnNIbDZ6OVc0UFpxWUJ2WnRxS1M4Y2xEXzR4bEhDZTgxTWJKcVh0aFdXbXB5RDFsdVdMOXZ1Z1REOVZMOXJ3czM3d2RCam1zSUtkWmxjNm9zcGdvNkFkX2NqTlp4YXlUWUNDQ2t3SUpKS0FBOHpFRnZUZ2xlZnNKZjl3ejVlTDlBcUxFcC1wS3BaU1lmVUx5MHRZWWRtNWFuSGd6NF9OZFJ0dzRYeUZnWjItc1N3Q1JJLThLUzFYZnByRDhOY1JsOE1QTjI5M1RSR29VOFNTRTBtUnY3d2tseDVNUTFHNF9MbW92X09FVk5MS3VWX0kyVXNKeHpXRkdWTTZhM1JXS0o2R2IyQU1LdXZYTHJQU2xzRFJGY253TWNaaDh0dU1ubkJtRlcwdlBMSjRQcXZIMW9GdEtSdUZicDFmVXh2WUxtLWV6RWFYQzRuQWxKMVBaRkkwODJVY2VhWTd5ekZuSldJZWtrOVFUT1FiUklfLVVFTl9xQ05zeTI1eVpRMy11aksyNkUwSG5yRW5tSWFJcHhVOXNxZHFSZXMzWGRhNEJ0VlROT1hDckk2Z2tDWUViUEY0SjZNUEdJNy1ja2Yta3ZkSS1oUzFvQ0NuVW9KR0hvazVqbE9OSkN4c3hIVmNVekNHNXVwQnZqcngwQUlwSl83d1JGOU0xODRYUGt2N1Fjc1ltZ1JudXNyT3FUZFNySk5JNEF3QlJPVlliSWFIOD0=) # <-- Put your encrypted keystore file here
                CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmcwNzltdmVKNUFBNC16RkFQOEl0TWdTSHkwaWl3cW1vMURUWDF6YnRiM0RLRURmS1BjTVdTT3dFdVhCd1JrR1J2cUtubDV1V21mN3NjNTBpZWtIN0h3Z0tSbmc9PQ==) # <-- Put your encrypted keystore password here
                CM_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmcwNzltdmVKNUFBNC16RkFQOEl0TWdTSHkwaWl3cW1vMURUWDF6YnRiM0RLRURmS1BjTVdTT3dFdVhCd1JrR1J2cUtubDV1V21mN3NjNTBpZWtIN0h3Z0tSbmc9PQ==) # <-- Put your encrypted keystore alias password here
                CM_KEYTORE_PATH: /tmp/keystore.keystore
                CM_KEY_ALIAS_USERNAME: Encrypted(Z0FBQUFBQmcwNy1LUWNqeXdnTmJlQ3hNRUdwWjk5SnpjN3BJV1VZNV9SNmJaLVFYcEJyMERERDIyVUJuX2dIWWRmZ1FIOEc2NVhyYnpfUkowa2lfNUIxbTZoM3VZU0liMVE9PQ==) # <-- Put your encrypted keystore alias username here
              node: latest
          triggering:
              events:
                  - push
                  - tag
                  - pull_request
              branch_patterns:
                  - pattern: develop
                    include: true
                    source: true
          scripts:
              - name: Install npm dependencies for Ionic project
                script: |
                  npm install
              - name: Set Android SDK location
                script: |
                  echo "sdk.dir=$ANDROID_SDK_ROOT" > "$FCI_BUILD_DIR/android/local.properties"
              - name: Set up keystore
                script: |
                  echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.keystore
                  cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
                  storePassword=$CM_KEYSTORE_PASSWORD
                  keyPassword=$CM_KEY_ALIAS_PASSWORD
                  keyAlias=$CM_KEY_ALIAS_USERNAME
                  storeFile=/tmp/keystore.keystore
                  EOF
              - name: Update dependencies and copy web assets to native project
                script: |
                  # npx cap copy # <- use this is you don't need to update native dependencies
                  npx cap sync # <- update native dependencies and copy web assets to native project
              - name: Build Android release
                script: |
                  cd android
                  ./gradlew assembleRelease
          artifacts:
              - android/app/build/outputs/**/*.apk
          publishing:
              email:
                  recipients:
                      - nihal@nevercode.io
                  notify:
                    success: true     # To not receive a notification when a build succeeds
                    failure: false     # To not receive a notification when a build fail
#               google_play:
#                     credentials: Encrypted(ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAicGMtYXBpLTY2OTc2NDE2OTI0NDMxNTUwNTItNjUwIiwKICAicHJpdmF0ZV9rZXlfaWQiOiAiYWU2YjBkODM3ZGM1NzQ0ODk0ZTM2NWJmYTExNDhkNTQyNmQ1OWUwYyIsCiAgInByaXZhdGVfa2V5IjogIi0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLVxuTUlJRXZRSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NCS2N3Z2dTakFnRUFBb0lCQVFDclhoTE1DVXNLK2RXZFxuK1JkQ2RxVVFLU0VKMWh5OUJxN0JFenZ1b1YwYitmYlo0OWNRcUVSdUpjaFdmbGp1T21Dd3JuYzQ5TUZIR28vWlxuYkgyNkd0UGYxUlRkOTFIbmQ4VUVPdHlmUFdEZlFHUWtzLzl4Y1g1NkhzWkd1SVBYNDdPV1RCbHJ5cVJtckZ5UFxuVkxzeThoTDg2cE9wTkQ0UEFVTzNuVUI0SU1OcVE3em9aUnJRakpTU0NLeHlnakpmVUhWVkZNVnI3dTBNMGptVlxuN25wUWRKQ3lVRGYwSWlpWnI3MXBMWEtwTDB1SWhKTlV4TjVXTnEvYytZSEJrQ2JkcVVTRmM1VjRQNThpM1lrQVxuRG1LWVNGbVFKNE9ITHo1ZThMWVVaQjJ5V3Exa0hhYnNiV1BoVmsxTHZkRXk0ZWlFelQzWlAxWmJwU2VtOVp2UVxub0oyTHRxRVhBZ01CQUFFQ2dnRUFHam8rcVpNRDM1S0IydU5adlB3SVRVM2pnWmJraW5CYkQxcDdRZzJEcTVsNVxuUDJYbDc1QmhVTWtLNkE5VVd3Nzg1MjJtK2tUemVUSWIzQXl2dld1eVlSVkNxVlRiUGVXUWRoSkZocFdsU0R0RVxuV0hNTllIWnlBMkljWkl5RVErYlVxengxdmpxaktNSlpORDFQOHFuUllDWWl6VjNINEdkZGVZZTJ3SmFseHozYlxuQ2F6c1ZSTERES0xMMTlBVUtJalNodHBZM3oxU09NL3FMbmt2dXdZUjFIejFCb0lrVlNDbnRYUWFtM0VMUm1rblxudGJFN2hoTENoaS9NeGZLc0xVUE12R213OW44ZWdzYm45MTNIK20zNnp1Qy9vMHpDSERQaVBMajVBQzdRdG5hd1xuSGZPeGRyQ0MwRUFVRFNUUmwxNXBSL0JxQlJmcldIZGQ4cm1DRFlwbTJRS0JnUURuTForWTRrNXo2QVZUemQ1TVxubzNZT01MMWw1a1pBVTlEUWt4S0tHd3lDMm14d3dxbVkzOHh3YUcxRTd2WjZmTjA3bFg1Q1lhQkNaQ3VkZHl5MFxuQ2lFRzlRSVp3WUZYbEhkZ3hVamMySmJoWTNEWHZteWFsZ0MzZDNPYlRkcWpST3E4YXY0S2UrVkVzR0FIYnE5Z1xuU3JxN1BWb3hNNFZ0blB3VHJVbzZjR1ppN1FLQmdRQzl4Ry9qT1FuWWdHcEt5U3h0UzBwZ25kQ2pUK2RGRW5NOVxudHdmWlZjUUVBdXJ5QWgwZ2FDR0E1V1V3WnVIeDZERWNUeGpYZVl0bEp5UUlFQXA5bTEvbDFFVjdNdGNwOGJhNlxuNEJpbU14dUFUWkJka0pWZ3RtcXYrc0ZSRDkwTDVyM0FxR01qaUtuUktUSzNJUlg4MWJFaUtzM0dxTUF6bGF6NFxuY1kxeDdQRy9rd0tCZ0NlZDR1N1JRWDZOY1hSR0lHVmowZFJtdDk1aGt3SnRHcWpUdTJhZGNneHVvQXpHMzBlS1xuZXI5OHRkVU5Xb0h0S2dDUEF0OGZXZFptMGk2ZkFMTXQxVEViQmF3aVJDY2RFMFFyS3V4bDFaMTBiQjhjekFIRlxuMlFPWDNlRHNlNTVsTGhEeUNPMEZCR284QzRqYWlBVnBhUXl6VytSNG50SUZDQkhiTFpCTU9NK1ZBb0dBV0s3TFxuWnhISjB4NjREYmtVQlFPUmY3Tmd4R0ZjQUFDT1VJSVByZmFSd3hvbDkvRWE4WUVZWHlkVThaaXk4SjBGRG1pOFxuZ0Q0eDhaU29Gd2lBRHBFazhNQVJ0SEJlOHlBZHVCbHdDNE9JejUzdjRIbm9CU2xhbEdFSUpMellIVzY0c0tkQVxucFdPQmtOakM5YWdGb1lHdjVQckI3WndCTGxvOVdtR2VxMllDMS9jQ2dZRUFnUkFVeENhWkJXdDg3QlNYbERTN1xuWkM3RW9XRDNBdGRxcDYxbXRwK3cxeEEyNmtqUU1tYm02SXJaem1kT09pVzJwS0s4dXowckV2N09NMnFrOTVJU1xudm1HTkcyemxNcHVTSHNaR1JKUDZUMEx4cy9hcGdVeTM4SDF5cXpuOCt2R1JOcWRKaHNXMmZTV1ZlMnVFcGM3UVxuL1FoaGlNakpINkJudjl5R3VFTWY0bms9XG4tLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tXG4iLAogICJjbGllbnRfZW1haWwiOiAiaW9uLW1lQHBjLWFwaS02Njk3NjQxNjkyNDQzMTU1MDUyLTY1MC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgImNsaWVudF9pZCI6ICIxMTUzNDQ4OTc0ODk2MTI4MDcyNzgiLAogICJhdXRoX3VyaSI6ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aCIsCiAgInRva2VuX3VyaSI6ICJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsCiAgImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjEvY2VydHMiLAogICJjbGllbnRfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9yb2JvdC92MS9tZXRhZGF0YS94NTA5L2lvbi1tZSU0MHBjLWFwaS02Njk3NjQxNjkyNDQzMTU1MDUyLTY1MC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIKfQo=)
#                     track: internal
